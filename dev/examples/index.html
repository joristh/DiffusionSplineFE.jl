<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Advanced Example · DiffusionSplineFE.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://joristh.github.io/DiffusionSplineFE.jl/examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">DiffusionSplineFE.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Advanced Example</a><ul class="internal"><li><a class="tocitem" href="#Model"><span>Model</span></a></li><li><a class="tocitem" href="#Results"><span>Results</span></a></li></ul></li><li><a class="tocitem" href="../details/">Details</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Advanced Example</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Advanced Example</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/joristh/DiffusionSplineFE.jl/blob/main/docs/src/examples.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Ghil-Sellers-Energy-Balance-Model"><a class="docs-heading-anchor" href="#Ghil-Sellers-Energy-Balance-Model">Ghil-Sellers Energy Balance Model</a><a id="Ghil-Sellers-Energy-Balance-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Ghil-Sellers-Energy-Balance-Model" title="Permalink"></a></h1><p>The entire code for this example can be found as a <a href="https://github.com/joristh/DiffusionSplineFE.jl/blob/main/example/GhilSellersEBM.ipynb">jupyter-notebook</a>.</p><h2 id="Model"><a class="docs-heading-anchor" href="#Model">Model</a><a id="Model-1"></a><a class="docs-heading-anchor-permalink" href="#Model" title="Permalink"></a></h2><p>The one-dimensional Ghil-Sellers energy balance model (<a href="https://doi.org/10.1175/1520-0450(1969)008&lt;0392:agcmbo&gt;2.0.co;2">Sellers1969</a>, <a href="https://doi.org/10.1175/1520-0469(1976)033&lt;0003:csfast&gt;2.0.co;2">Ghil1976</a>, <a href="https://doi.org/10.1007/s00382-014-2206-5">Bdai2014</a>) is given by the diffusion equation</p><p class="math-container">\[\begin{align*}
    c(x)T_t = \left( \frac{2}{\pi}\right)^2 \frac{1}{\cos(\pi x/2)} \left[\cos(\pi x/2) k(x,T)T_x)\right]_x + \mu Q(x) \left[1 - \alpha(x, T)\right] - \sigma T^4 \left[1 - m \tanh(c_3T^6)\right]
\end{align*}\]</p><p>where <span>$x = 2\phi/\pi \in [-1, 1]$</span> with homogeneous Neumann boundary conditions and a prescribed initial condition. The diffusive term <span>$k(x,T)$</span> is governed by eddy diffusivities for sensible and latent heat</p><p class="math-container">\[\begin{align*}
	k(x, T) &amp;= k_1(x) + k_2(x)g(T)\\
	g(T) &amp;= c_4/T^2 \exp(-c_5/T).
\end{align*}\]</p><p>The temperature- and latitude-dependent albedo is given by</p><p class="math-container">\[\begin{align*}
	\alpha(x, T) = \left\{ b(x) - c_1 [T_m + min(T-c_2 z(x) - T_m, 0)] \right\}_c
\end{align*}\]</p><p>with the cutoff function</p><p class="math-container">\[\begin{align*}
	h_c = 
	\begin{cases}
		h_{min}, &amp; h \leq h_{min}\\
		h, &amp; h_{min} &lt; h &lt; h_{max}\\
		h_{max}, &amp; h_{max} \leq h
	\end{cases}
\end{align*}\]</p><p>All parameters (constants and functions) are empirically found and interpolated values from the original paper by Sellers are used.</p><p>Multiplying with <span>$\cos(\pi x/2)$</span>, the energy balance model can be rewritten in general form which yields</p><p class="math-container">\[\begin{align*}
	C(x) &amp;= \cos(\pi x/2) c(x)\\
	D(x, T) &amp;= \left(\frac{2}{\pi}\right)^2 \cos(\pi x/2) k(x, T)\\
	S(x, T) &amp;= \cos(\pi x/2) \left( \mu Q(x) \left[1 - \alpha(x, T)\right] - \sigma T^4 \left[1 - m \tanh(c_3T^6)\right] \right)
\end{align*}\]</p><p>and solved with DiffusionSplineFE.jl.</p><h2 id="Results"><a class="docs-heading-anchor" href="#Results">Results</a><a id="Results-1"></a><a class="docs-heading-anchor-permalink" href="#Results" title="Permalink"></a></h2><p>The figure shows equilibrium states for two close initial conditions. The ODEs are integrated until <span>$t_{end} = 3 \cdot 10^9$</span> with implicit Crank-Nicolson. Using fifth order explicit Runge-Kutta gives very similar results and the system does not show stiff behavior.</p><p><img src="../EBM_states.png" alt="EBM_states.png"/></p><p>In comparison to the finite difference implementation in <a href="https://github.com/maximilian-gelbrecht/GhilSellersEBM.jl">GhilSellersEBM.jl</a> there are no oscillations and instabilities when starting close to the separatrix between stable hot and cold states. At the same time, the Neumann boundary conditions are exactly fulfilled by use of a recombined spline space which is not true for the FD approach. Even with a very low dimensional spline space (<span>$n=11$</span>), the resulting behavior is qualitatively and quantitatively comparable to <a href="https://github.com/maximilian-gelbrecht/GhilSellersEBM.jl">GhilSellersEBM.jl</a>.</p><p><img src="../EBM_Comparison.gif" alt="EBM_Comparison.gif"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../details/">Details »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 21 March 2023 19:19">Tuesday 21 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
